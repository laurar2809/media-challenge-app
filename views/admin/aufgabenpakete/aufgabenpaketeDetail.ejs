<% pageTitle = aufgabenpaket.title %>

<a href="/aufgabenpakete" class="btn btn-outline-secondary btn-sm px-3 mb-2">← Zurück zu Übersicht</a>

<div class="card">
  <div class="card-header p-4 text-center bg-light border-0">
    <h2 class="h3 mb-3 fw-bold text-dark">
      <%= aufgabenpaket.title %>
    </h2>
    
    <% if (aufgabenpaket.kategorie) { %>
    <div class="d-flex justify-content-center gap-1 flex-wrap mb-4">
      <span class="badge bg-secondary">
        <%= aufgabenpaket.kategorie %>
      </span>
    </div>
    <% } %>

    <!-- Icon/Image -->
    <% if (aufgabenpaket.icon && aufgabenpaket.icon.startsWith('/uploads/')) { %>
      <div class="challenge-image-container">
        <img src="<%= aufgabenpaket.icon %>" class="challenge-detail-image-full rounded shadow-sm"
          alt="<%= aufgabenpaket.title %>">
      </div>
    <% } else if (aufgabenpaket.icon && (aufgabenpaket.icon.startsWith('http') || aufgabenpaket.icon.startsWith('data:'))) { %>
      <div class="challenge-image-container">
        <img src="<%= aufgabenpaket.icon %>" class="challenge-detail-image-full rounded shadow-sm"
          alt="<%= aufgabenpaket.title %>">
      </div>
    <% } else if (aufgabenpaket.icon) { %>
      <div class="challenge-image-container">
        <div class="challenge-main-placeholder rounded shadow-sm">
          <span class="icon-display display-4 opacity-25"><%= aufgabenpaket.icon %></span>
        </div>
      </div>
    <% } else { %>
      <div class="challenge-image-container">
        <div class="challenge-main-placeholder rounded shadow-sm">
          <i class="bi bi-image display-4 opacity-25"></i>
        </div>
      </div>
    <% } %>
  </div>
</div>

  <div class="card-body p-3">
    <div class="row g-2">
      <div class="col-md-8">
        <% if (aufgabenpaket.description) { %>
        <div class="mb-2">
          <small class="text-muted d-block mb-1">Beschreibung</small>
          <div class="lh-sm small">
            <%= aufgabenpaket.description %>
          </div>
        </div>
        <% } %>
      </div>

      <div class="col-md-4">
        <div class="d-flex flex-column h-100">
          <div class="flex-grow-1">
            <div class="mb-2">
              <small class="text-muted">Erstellt</small>
              <div>
                <%= aufgabenpaket.created_at ? new Date(aufgabenpaket.created_at).toLocaleDateString('de-DE') : '-' %>
              </div>
            </div>
            <div class="mb-2">
              <small class="text-muted">Geändert</small>
              <div>
                <%= aufgabenpaket.updated_at ? new Date(aufgabenpaket.updated_at).toLocaleDateString('de-DE') : '-' %>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Buttons unten -->
  <div class="card-footer bg-transparent p-3 border-0">
    <div class="d-flex gap-2 buttons-compact">
      <a href="/aufgabenpakete/<%= aufgabenpaket.id %>/edit" class="btn btn-custom-safe btn-sm px-3">Bearbeiten</a>
      <button type="button" class="btn btn-custom-delete btn-sm px-3" 
              data-bs-toggle="modal" data-bs-target="#confirmDeleteModal">
        Löschen
      </button>
    </div>
  </div>


<%- include('../../partials/deleteModal', {
  modalId: 'confirmDeleteModal',
  formId: 'deleteConfirmForm',
  submitButtonId: 'confirmDeleteSubmit',
  title: 'Aufgabenpaket löschen',
  bodyText: 'Bist du sicher, dass du dieses Aufgabenpaket löschen möchtest?'
}) %>
